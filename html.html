
<html>
  <head>
    <meta charset="utf-8">
    <title>force-layout</title>
    <style>
      .forceLine{
        stroke: #444;
        stroke-width: 2;
      }
      .forceCircle{
        stroke: black;
        stroke-width: 2;
      }
      .forceText{
        fill: black;
        font-size: 20;
        font-family: serif;
        text-anchor: middle;
      }
    </style>
  </head>

  <body>
    <script src="d3/3.x/d3.min.js" charset="utf-8"></script>
    <script>
      var width = 400;
      var height = 400;

      var svg = d3.select("body")
                  .append("svg")
                  .attr("width", width)
                  .attr("height", height);

      var nodes = [
        {name: "0"},
        {name: "1"},
        {name: "2"},
        {name: "3"}];

      var edges = [
        {source: 0, target: 3},
        {source: 1, target: 2},
        {source: 3, target: 1},
        {source: 0, target: 1}]；

        var force = d3.layout.force()
                      .nodes(nodes)
                      .links(edges)
                      .size([width,height])
                      .linkDistance(90)
                      .charge(-400);

        force.start();
      //  console.log(nodes);	//输出转换后的数据
	//	console.log(edges);

      var color = d3.scale.category20();

      var lines = svg.selectAll(".forceLine")
                     .data(edges)
                     .enter()
                     .append("line")
                     .attr("class", "forceLine");

      var circles = svg.selectAll(".forceCircle")
                       .data(nodes)
                       .enter()
                       .append("circle")
                       .attr("class", "forceCircle")
                       .attr("r", 20)
                       .style("fill", function(d, i){return color(i);})
                       .call(force.drag);

      var texts = svg.selectAll(".forceText")
                     .data(nodes)
                     .enter()
                     .append("text")
                     .attr("class", "forceText")
                     .attr("x",function(d){return d.x;})
                     .attr("y",function(d){return d.y;})
                     .attr("dy", ".3em")
                     .text(function(d){return d.name;})

      force.on("tick", function(){

        lines.attr("x1", function(d){return d.source.x;});
        lines.attr("y1", function(d){return d.source.y;});
        lines.attr("x2", function(d){return d.target.x;});
        lines.attr("y2", function(d){return d.target.y;});

        circles.attr("cx", function(d){return d.x;});
        circles.attr("cy", function(d){return d.y;});

        texts.attr("x", function(d){return d.x;});
        texts.attr("y", function(d){return d.y;});
      });

      //var drag = force.drag()
                    //  .on("dragstart", function(d){d.fixed = true;})
                      //.on("dragend", function(d,i){d3.select(this).style("fill", color(i));})
                    //  .on("drag", function(d){d3.select(this).styke("fill", "yellow");});

                //force.on("start", function(){
                			//console.log("运动开始");
                		//});

                		//力学图运动结束时
                		//force.on("end", function(){
                			//console.log("运动结束");
                		//});

      </script>
    </body>
  </html>
